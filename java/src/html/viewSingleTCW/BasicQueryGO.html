<!DOCTYPE html>
<html>
<head>
<title>Basic Queries for GO Annotation</title>
</head>
<body style="padding:20px;width:650px;font-family:Times">

<h1>Basic Queries for GO Annotation</h1>
<i>Overview</i>: 
Select <b>Search</b> to search for the string in the text box, or select <b>Filters</b> to apply the
filters set. Select a check box or radio button to enable the associated search or filter.
<p>This is the main interface for queries related to gene ontology.
See <b>GO Help</b> for a description of terms. First, a few facts:
<ol>
<li>A GO ID is only in the TCW database if it has an assigned or inherited hit. 
<li>The Gene Ontology is constantly evolving, hence, TCW will only be consistent with
the Gene Ontology if TCW was built with the latest GO database from 
www.geneontology.org (the GO version is listed in the <b>Overview</b> panel).
</ol>

<hr>
<h2>Search</h2>
<ul>
<li><b>GO ID </b>&nbsp;&nbsp;The GO number, e.g. GO:0003674, or 3674. 
(<i>Must use one of these formats!</i>). Only one GO ID is allowed unless loaded from file.
<li><b>GO Name </b>&nbsp;&nbsp;All GO names are searched for the substring.
</ul>
<b>Load File</b>: The file should contain one GO ID or one GO Name per line,
depending on whether <b>GO ID</b> or <b>GO Name</b> is selected. <i>GO Name and GO ID must
be the exact text when loaded from file</i>.
<hr>

<h2>Filters</h2>
<b>Seq-Hit:</b>
<table cellpadding=5>
<tr><td valign=top><b>E-value</b> <td>The best e-value is assigned to each GO. That is,
the hits are associated with zero or more GOs, and the sequence-hit pairs 
have e-values; this is the best sequence-hit e-value associated with the GO.
It will be the top hit on the <b>Show...</b> option <u>Sequence  - has Hit with GO</u>.

<tr><td valign=top><b>#Seqs</b><td> By default, this is the number of sequences with 
at least one hit with this GO assigned or inherited. See <b>#Seqs</b> section towards
the end, which explains how this will be different if the <b>DE #Seqs</b> is changed.

<tr><td valign=top><b>Evidence</b><td> Check the box, then select <b>Evidence</b> to bring
up a panel of available evidence categories.  The filter is passed if a GO
has <b>any</b> of the selected categories. See <b>Info</b> for the mapping of Evidence Codes
to Categories.
</table>

<p><b>Level:</b>  See <b>GO Help</b> for a description of levels. 
<table cellpadding=5>
<tr><td valign=top><b>All Ontology</b><td> This toggles between "biological_process" (BP), "cellular_component" (CC)
and "molecular_function" (MF).
<tr><td valign=top><b>Specific</b><td> Specify a specific level.
<tr><td valign=top><b>Range</b><td> Specify a range of levels.
<tr><td valign=top><b>Slim</b><td> If GO slims were identified when the database was created, this option will be present.
If checked, only the GO slims will be shown (plus filtered by any other option, e.g. E-value).
The type of <tt>GO slims</tt> is shown on the <b>Overview</b> panel, e.g. <tt>goslims_plant</tt>.
</table>

<p><b>Enrich:</b>
<br>If GO enrichment p-values have been computed,
you will see a row labeled <b>Enrich</b> on the main window; otherwise, ignore this section.
By default, the p-values are computed using <tt>GOseq</tt> package, see the <tt>Overview</tt> for the method.
<p>
Filter on the p-values as follows:
<ol>
<li>Check the box to the left of <b>Enrich:</b> and adjust the cutoff in the text entry
box on the right.
<li>This is followed by the word <b>for</b> and a button. This button will initially
be labeled <b>Any N</b> where N is the number of p-value columns. 
To change the selection, select the button which will bring up
a panel of all p-value column names; select the columns to query on. Choose one of the two
options for applying the cutoff, either:
<ol type="a">
<li><b>Any</b> shows results for which any of the selected p-value columns pass the threshold.
<li><b>Every</b> shows results for which all columns pass the threshold.
</ol>
<li><b>#Seqs</b>  see the <b>#Seqs</b> section towards the end of this Help.
</ol>

<hr>
<h2>Results</h2>
Select one or more filters, then click <b>BUILD TABLE</b> or <b>ADD to TABLE</b> to execute the 
search, which builds a new table or adds to the existing table, respectively.
<p>Using the <b>Columns</b> button, columns can be added/removed. 
Columns can be rearranged by dragging and sorted
by clicking on a column heading. 

<p><b><i>Columns</i></b> 
<ul>
<li>These are all obvious except the column <b>GO</b>, which is the GO Ontology (BP, CC, MF).
<li>P-values: See <b>Decimal Display</b> on upper left panel.
<li>Evidence categories: The <b>Long</b> format shows the evidence codes found for the category,
where the inherited codes are in parenthesis. The <b>Short</b> format just states 'Yes' if it 
has one or move evidence codes in the category.
 </ul>
<p><b><i>Modify Table</i></b>
<ul>
<li><b>Delete Selected</b> and <b>Deleted Unselected</b>: 
The selected rows or unselected rows will be removed, respectively. The corresponding rows will
be removed from the other (not-displayed) list.
<li><b>Select All</b> and <b>Unselect All</b>: Selects and unselects all rows, respectively.
</ul>

<hr>
<h2>Top row of options</h2>
<i><b>Selected:</b></i>
<ul>
<li><b>View Seqs</b> view the sequences in the main table for the selected GO.

<li><b>Copy...</b> to the clipboard, which can be pasted elsewhere
<ol type='a'>
<li><u>Go ID</u>&nbsp;&nbsp;from corresponding column
<li><u>GO Name</u>&nbsp;&nbsp;from corresponding column
</ol>

<li><b>Show...</b> 

<ol type='a'>
<li><u>Hits - assigned</u>&nbsp;&nbsp; 
All proteins in the database that have this GO directly assigned to them.
<br>&nbsp;

<li><u>Hits - inherited</u>&nbsp;&nbsp; 
All proteins in the database that inherited the GO. 
Each hit is associated with one descendant  GO; a hit may have multiple descendant 
GOs to the selected one (a note at the bottom of the
popup will say "Multiple Descendant GO Hits:" followed by the number). 
NOTE: This query can be slow if there are many descendant  GOs that have many assigned
proteins; some have &gt; 1000.
<br>&nbsp;

<li><u>Sequences - has hit with GO</u>&nbsp;&nbsp;
This shows the sequences that have a hit that has been assigned or inherited
the GO. The associated hit information is a bit confusing, but is as follows:
<ul>
<li>If the sequence has multiple hits with the GO, only the one with the best E-value
is shown. This is not necessarily a hit with the GO assigned.
<li>If the <b>View Seqs</b> is used, 
the resulting table only shows the GO hits if it is 'Best Bits' or 'Best Anno',
which is not the same as this "Best". 
<li>All sequences with the GO are shown, regardless of their DE values.
</ul>

<li><u>GO - Neighborhood with relations</u>&nbsp;&nbsp;
The immediate parents and children of the GO ID. 
The relation of 'is_a' or 'part_of' is shown for this option.
NOTE: same note as for descendants. Starting with sTCW v3.1.8, there is also a relation 'replaced_by'
and 'replaces'.
<br>&nbsp;

<li><u>GO - Ancestors</u>&nbsp;&nbsp;  
All ancestors of the GO ID sorted by level. 
<br>&nbsp;

<li><u>GO - Descendants</u>&nbsp;&nbsp; 
All descendants of the GO ID sorted by level. 
NOTE: if a descendant  GO does not have any assigned or inherited hits, it is not in the
database so is not shown. 
<br>&nbsp;
<li><u>GO - Ancestor path table</u>&nbsp;&nbsp;  
The same GOs as in the Ancestor List, but shows the paths in table form. If all paths have the 
same GOs at the top and bottom of the graph, they are only shown once and the row will be gray.
NOTE: Occasionally, this query may be slow when there are many paths for the GO; some GOs have over 1000 paths.
<br>&nbsp;
<li><u>GO - Related in table</u>&nbsp;&nbsp; 
A list of the GOs ancestors and descendants will be listed IF they are also in the 
table. The GOs will be listed in the same order as found in the table.
</ol>

<li><b>Export...</b>&nbsp;&nbsp; The exact same options as above, but the results are written
to file. When an "*" is at the end of the option, this indicates that there will 
be a choice between writing <u>All Info</u> or <u>ID only</u>. For example, if the <u>Hits - assigned*</u>
is selected and <u>ID only</u> is then selected in the popup window, the HitIDs will be written
to file; this is useful for loading in the <b>Basic Hit</b> panel to view.
</ul>

<p><i><b>Table:</b></i>
<ul><li><b>Show...</b>
<ol type='a'>
<li><u>Show Columns Stats</u>&nbsp;&nbsp;A popup window of statistics for the numeric columns.
<br>&nbsp;
<li><u>Each GO parents with relations</u>&nbsp;&nbsp;For each GO in table, print its parents and relations (e.g. <tt>is_a</tt>)
<br>&nbsp;
<li><u>Set of ancestors</u>&nbsp;&nbsp;The combined list of ancestors for all GOs in the table, sorted by level.
<br>&nbsp;
<li><u>Longest paths</u>&nbsp;&nbsp;  The longest paths of the GOs in the table;
that is, shorter paths that are contained in another will not be shown. NOTE: This can take minutes
to compute and be large.
<br>&nbsp;
<li><u>All paths</u>&nbsp;&nbsp;All paths of the GOs in the table. NOTE: This can be a very large.

</ol>

<li><b>Export...</b>
<ol type='a'>
<li><u>Table columns</u>&nbsp;&nbsp;A tab-delimited file of the contents of the table.
<br>If you just select two columns, (GO ID, #Seqs) or (GO ID, P-value), 
the exported file can be used as input to REVIGO (http://revigo.irb.hr). 
<br>&nbsp;
<li><u>GO IDs</u>&nbsp;&nbsp;A single column file of only the GO IDs from the table.
<br>&nbsp;
<li><u>Export SeqIDs with GOs</u>&nbsp;&nbsp;A tab-delimited file of each SeqID followed by
its list of assigned and inherited GOs (from associated seq-hit list), where the GOs are from the displayed GO table. 
<br>This can be used as input to WeGO (http://wego.genomics.org.cn/) using native format.
<br>&nbsp;

<li><u>Create/Merge #Seqs</u>&nbsp;&nbsp;A tab-delimited file that contains
the GOs grouped by ontology, followed by the GO-Name and #Seqs. The merge
allows multiple columns of #Seqs based on different queries (e.g. two different
p-values).  The file must not be edited until
all #Seqs columns are added (TCW needs the format exact). The resulting file can
be used in Excel to make bar graphs.
<br>&nbsp;

<li>The next four option are the same as option b-e of <b>Show...</b>.
<br>&nbsp;
<li><u>Copy Table</u>&nbsp;&nbsp;Copy the table to the clipboard for pasting elsewhere.
</ol>
</ul>
<hr>
<h2>#Seqs</h2>
There are two occurrences <b>#Seqs</b> on this panel, and the second effects the column <b>#Seqs</b>. 
<ol>
<li><b>Seq-hit: #Seqs</b>: If this is set, the GOs displayed must
have at least this many sequences associated with the GO ID.
<br>&nbsp;
<li><b>Enrich: #Seqs</b>: 
<ul>
<li><b>All</b>&nbsp;&nbsp;The count is all Seqs with the GO, regardless of DE value. 
<li><b>DE</b>&nbsp;&nbsp;The count is all sequences with the GO that are considered DE for the selected set of p-values. 
<li><b>upDE</b>&nbsp;&nbsp;From the <b>DE</b> set, only the ones that are up-regulated.
<li><b>dnDE</b>&nbsp;&nbsp;From the <b>DE</b> set, only the ones that are down-regulated.
</ul>The relation between the GOseq p-value and when a sequence is considered DE is explained below
under <i>DE Sequence</i>. NOTE: when this is it set to something
other than <b>All</b>, it is much slower!
<br>&nbsp;
<li> <b>Column #Seqs</b>&nbsp;&nbsp; This is typically all sequences that have a hit
associated with the GO, unless the <b>Enrich: #Seqs</b> is changed from <b>All</b>.
<br>&nbsp;
<li><b>View Seqs</b>&nbsp;&nbsp;This shows the sequences that correspond with the <u>#Seqs</u> column 
in the table.
</ol> 
<i>DE Sequence</i>: Each sequence has the following annotations:
<ol>
<li>Sequence length.
<li>Zero or more hits, where many are associated with GO IDs.
<li>Read counts for different conditions along with DE p-values 
between pairs of conditions.
</ol>
<tt>GOseq</tt> uses all the above information to determine the over-represented GOs for
two conditions.
For input to <tt>GOseq</tt>, a binary vector is created of N sequences (where N
is the number of sequences with GOs); the value for a sequence is a 1
if it is DE, else it is 0. The scientist that executes <tt>GOseq</tt> via <tt>runDE</tt> sets 
the cutoff for DE, e.g. 0.05. The <b>Overview</b> panel under 
"Processing" states what the cutoff was, e.g. RoSt:0.05 indicates that the 
corresponding DE p-values
used a cutoff of 0.05. Hence, the DE count is the number that was used by <tt>GOseq</tt>
to calculate the GO p-value, where DE=upDE+dnDE. <i>TO BE CLEAR:</i> The #DE sequences
is not based on the cutoff from the panel, but based on the cutoff used for input to <tt>GOseq</tt>.
<p>If the <b>for</b> filter is on two or more conditions where "and" is used (e.g. StRo and StOl), 
the #Seqs=DE is an "or" of the individual conditions; it is done that way to account for 
the sequences that went into the GO P-values.
For example, try selecting #Seq=upDE, then select a row followed by <b>View Seqs</b>; at least one of the two
conditions will be up-regulated; however, on the <b>Basic GO</b> panel, both the conditions will
be &lt;Pval.
</body>
</html>