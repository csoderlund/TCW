<!DOCTYPE html>
<HTML>
<!--#set var=TITLE value="TCW installing on MacOS" -->
<!--#include virtual="./ssi/head.html" -->
<!--#include virtual="./ssi/start1.html" -->
<a name=top>


<h2>Running TCW on MacOS</h2>

The following includes:
<ul>
<li><a href=#prob>Problems on Mac</a>
<li><a href=#cat1>Installation on MacOS 10.15.4</a> (May2020)
<li><a href=#ext>Running /Ext/mac external programs</a>
</ul>

<a name=prob> 
<h3>Problems on Mac</h3>

I've run TCW extensively on my Mac, and found a few slight Java problems:
<ul>
<li>The Export sequences from a table does not work when there are many sequences. Edit the viewSingleTCW file to increase the memory size,
and don't do anything in the TCW interface or click on the table until the file is written. If that doesn't work, limit the size of the table
to be written.
<li>In runSingleTCW and runMultiTCW, the interface does not always automatically update until I click in the window.
<li>Pop-up windows can get hidden behind the main window, and it makes TCW appear to be frozen -- move the main TCW window to find the
hidden window.
<li>The buttons are all white, and the highlighting on the GO tree is very light. Occasionally, the highlighting causes text to disappear.
<li>The UniProt search links do not work; hence, are not provided on Mac.
</ul>



<a name=cat1>
<h3>
		Installation on MacOS 10.5.4 (Catalina)
</h3>
	Here are my notes from my installation on my personal Mac v10.15 with Java v14.0.1 (May 2020). It is necessary
	to use TCW v5.0.3 or higher with MySQL v8.  
	<h4>
		MySQL
	</h4>
	<ol>
		<li>Download from <a href="http://dev.mysql.com" class="ext" target="_blank">
		dev.mysql.com</a> mysql-8.0.17-macos10.14-x86_64.dmg.
		Click the '.dmg' file and follow the instructions. 
		<p>
		<li>
		There will be a mySQL icon on your System Preferences, where you can start/stop the MySQL server. <br>
		&nbsp; 
		<li>Test: I use tcsh, so I enter the following into the .tcshrc file: <pre>
	alias mys '/usr/local/mysql/bin/mysql -u root -p[password]'
		</pre>
		From the command line, I execute <tt>source .tcshrc</tt>. If you are using zch or bash, you will need to use their equivalent commands. 
		<p>
			From the command line, enter 'mys', and then at the prompt: <pre>
        >create database mytest;
        >drop database mytest;
			</pre>
			<li>In the HOSTS.cfg of the TCW package, set DB_user=[mysql userid], DB_password=[mysql password] 
	</ol>
	<p>
		At this point, <code>runSingleTCW</code> and <code>runMultiTCW</code> can build databases and view them. 
		However, you will not be able to run DE calculations without installing R, or <code>OrthoMCL</code> 
		without installing the Perl-mysql interface. 
		
	<h4>
		R and R-Java interface
	</h4>
		<ol>
		<li>Download from <a href=//cran.r-project.org/bin/macosx>cran.r-project.org/bin/macosx</a> the
		file R-4.0.0.pkg. Click to install.
		<p>
		<li>Type 'R' at the terminal prompt, then the following:
<pre>
>install.packages("rJava")
>if (!requireNamespace("biocManager", quietly=TRUE))
>install.packages("BiocManager")
>BiocManager::install(version = "3.11")
>BiocManager::install("edgeR")
>BiocManager::install("goseq")
>BiocManager::install("DESeq2")
</pre>
<li>Set your $R_HOME (assuming tcsh)
<pre>
setenv R_HOME /Library/Frameworks/R.framework/Resources
</pre>
<li>Make sure <code>runDE</code> has the following: 
<pre>
-Djava.library.path=/Library/Frameworks/R.Framework/Resources/library/rJava/jri
</pre>
		</ol>
		<h4>
			Perl-mySQL interface
		</h4>
		When I googled Perl-MySQL MacOX 10.15, I saw people are running into difficulties with this.
		One person wrote:
		<font color=green><pre>
	"The solution is simple: Don't use the Apple flavors of Perl, build your own from scratch and use that. Then:
	cpan install DBI
	cpan install DBD::mysql"
		</font></pre>
		<p>I have not tried this yet.
<p>The following instructions are from an earlier version of this document (for MacOS 10.9.5):
<pre>
	added 'set $path=($path /usr/local/perl/bin)' to my .tcshrc

	>cpan install DBD::mysql

	cd .cpan/build/DBD-mysql-4.029-[a unique string will end this directory name]
	sudo ln -s /usr/local/mysql/lib/*.dylib
	perl Makefile.PL --testuser=[mysql userid] --testpassword=[mysql password]
	make 
	make test
	sudo make install
	sudo ln -s /usr/local/mysql/lib/libmysqlclient.18.dylib /usr/lib/libmysqlclient.18.dylib
</pre>

<a name=ext>
<h3>
	Running /Ext/mac external programs
</h3>
MacOS 10.15 has made it difficult to run programs downloaded from the web unless its been
authenticated by Apple. Running through TCW,
you will either get popup that states "xxx cannot be opened because developer cannot be verified", or
the program will just fail. Do the following:
<ol>
<li>Using the Finder, select the program and Open With "Terminal" or "iTerm".
<li>You will get a pop-up, select "Open".
<li>After that, you will be able to run it via TCW.
</ol>
I did not have to do this for <code>Blast</code>, but I did need to do it for the other <tt>/Ext/mac</tt> programs.
All were straight-forward except for <code>mafft</code>; I had to authenticate all the following in the <tt>mafftdir</tt>
directory: 
<pre>
bin/
	mafft
libexec/
	version
	countlen
	splittbfast
	tbfast
	disttbfast
	dvtditr
	f2cl
</pre>
There is a way to allow any downloaded program to execute by using:
<pre>
sudo spctl --master-disable
</pre>
Then in Preferences, Security&Privacy, General, select 'anywhere'. I did not try this.
<!--#include virtual="./ssi/end.html" -->

</HTML>

